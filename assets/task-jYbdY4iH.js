import"./changetorigistrated-BOB7qmil.js";import{t as a,r as i,a as c,c as l,d,o as g,s as u}from"./createchat-DGe1-lI6.js";import"./main-D3axStbB.js";const m="https://harry-potter-test-preparation-backend.onrender.com/",s=document.querySelector(".condition"),h=document.querySelector(".all-in-auestion");document.querySelector(".question-elements");function p(){let n=localStorage.getItem("taskId"),o=localStorage.getItem("token");return fetch(`${m}topic/task/${n}`,{method:"GET",headers:{Authorization:"Bearer "+o,"ngrok-skip-browser-warning":"69420","Content-Type":"application/json"}}).then(t=>{if(!t.ok)throw new Error(`HTTP Error: ${t.status}`);return t.json()}).then(t=>{if(s.innerHTML=`${t.condition}`,t.captionPicture){const e=document.createElement("img");e.setAttribute("src",t.captionPicture),e.classList.add("task-picture"),h.appendChild(e)}return localStorage.setItem("condition",t.condition),a(t),i(s),t}).catch(t=>{console.error("Error fetching task details:",t)})}const k="https://harry-potter-test-preparation-backend.onrender.com/";function S(){console.log(localStorage.getItem("taskId"),localStorage.getItem("type"),localStorage.getItem("selectedOption"));let n=localStorage.getItem("token"),o=localStorage.getItem("type"),t;switch(o){case"options":t=JSON.stringify({selectedOptionId:localStorage.getItem("selectedOption"),_id:localStorage.getItem("taskId"),type:o});break;case"input":const e=document.querySelector(".question-input");t=JSON.stringify({answer:e.value.trim(),_id:localStorage.getItem("taskId"),type:o});break;case"match":let r=localStorage.getItem("answers");if(!r)return;r=JSON.parse(r),t=JSON.stringify({answer:r,_id:localStorage.getItem("taskId"),type:o});break;default:console.error("Unknown task type:",o);return}return fetch(`${k}answers`,{method:"POST",headers:{Authorization:"Bearer "+n,"ngrok-skip-browser-warning":"69420","Content-Type":"application/json"},body:t}).then(e=>{if(!e.ok)throw new Error(`HTTP Error: ${e.status}`);return e.json()}).then(e=>{e.score===e.maxScore||e.taskResults.score===e.maxScore?(alert(`Вітаємо ви вирішили правильно і отримали ${e.maxScore}`),localStorage.setItem("selectedOption",""),console.log(window.location.href="topics.html")):alert("Нажаль ви вирішили не вірно, спробуйте ще раз"),console.log(e)}).catch(e=>{console.error(e)})}const y=document.querySelector(".close-btn"),I=document.querySelector(".chat-svg"),f=document.querySelector(".finish-task"),w=document.querySelector(".send-messege-btn"),E=document.querySelector(".delete-chat-btn");I.addEventListener("click",()=>{c(),(localStorage.getItem("isChatExist")=="false"||localStorage.getItem("isChatExist")==null)&&l()});E.addEventListener("click",()=>{d(),c()});window.addEventListener("load",()=>{localStorage.getItem("isChatExist")=="true"&&g()});w.addEventListener("click",()=>{u()});y.addEventListener("click",()=>{c()});window.addEventListener("load",()=>{p()});f.addEventListener("click",()=>{S()});
