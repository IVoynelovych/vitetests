import"./changetorigistrated-k4dA9IUW.js";import{t as i,r as l,a as c,c as d,d as u,o as g,s as m}from"./createchat-DARiIhxJ.js";import"./main-DiX3ARcM.js";const p="https://harry-potter-test-preparation-backend.onrender.com/",a=document.querySelector(".condition"),h=document.querySelector(".all-in-auestion");document.querySelector(".question-elements");function k(){let r=localStorage.getItem("taskId"),o=localStorage.getItem("token");return fetch(`${p}topic/task/${r}`,{method:"GET",headers:{Authorization:"Bearer "+o,"ngrok-skip-browser-warning":"69420","Content-Type":"application/json"}}).then(t=>{if(!t.ok)throw new Error(`HTTP Error: ${t.status}`);return t.json()}).then(t=>{if(a.innerHTML=`${t.condition}`,t.captionPicture){const e=document.createElement("img");e.setAttribute("src",t.captionPicture),e.classList.add("task-picture"),h.appendChild(e)}return localStorage.setItem("condition",t.condition),i(t),l(a),t}).catch(t=>{console.error("Error fetching task details:",t)})}const S="https://harry-potter-test-preparation-backend.onrender.com/";function y(){console.log(localStorage.getItem("taskId"),localStorage.getItem("type"),localStorage.getItem("selectedOption"));let r=localStorage.getItem("token"),o=localStorage.getItem("type"),t;switch(o){case"options":t=JSON.stringify({selectedOptionId:localStorage.getItem("selectedOption"),_id:localStorage.getItem("taskId"),type:o});break;case"input":const e=document.querySelector(".question-input");let s=e.value.trim();e.value.length==0&&(s=" "),t=JSON.stringify({answer:s,_id:localStorage.getItem("taskId"),type:o});break;case"match":let n=localStorage.getItem("answers");if(!n)return;n=JSON.parse(n),t=JSON.stringify({answer:n,_id:localStorage.getItem("taskId"),type:o});break;default:console.error("Unknown task type:",o);return}return fetch(`${S}answers`,{method:"POST",headers:{Authorization:"Bearer "+r,"ngrok-skip-browser-warning":"69420","Content-Type":"application/json"},body:t}).then(e=>{if(!e.ok)throw new Error(`HTTP Error: ${e.status}`);return e.json()}).then(e=>{e.score===e.possibleScore?(alert(`Вітаємо ви вирішили правильно і отримали ${e.possibleScore}`),localStorage.setItem("selectedOption",""),window.location.href="topics.html"):alert(`Нажаль ви вирішили не вірно, спробуйте ще раз, адже ви отримали ${e.score} з ${e.possibleScore}`),console.log(e)}).catch(e=>{console.error(e)})}const I=document.querySelector(".close-btn"),f=document.querySelector(".chat-svg"),w=document.querySelector(".finish-task"),b=document.querySelector(".send-messege-btn"),E=document.querySelector(".delete-chat-btn");f.addEventListener("click",()=>{c(),(localStorage.getItem("isChatExist")=="false"||localStorage.getItem("isChatExist")==null)&&d()});E.addEventListener("click",()=>{u(),c()});window.addEventListener("load",()=>{localStorage.getItem("isChatExist")=="true"&&g()});b.addEventListener("click",()=>{m()});I.addEventListener("click",()=>{c()});window.addEventListener("load",()=>{k()});w.addEventListener("click",()=>{y()});
